<!DOCTYPE html>
<html lang="en">
	<!-- Head -->
	<head>
		<meta charset="UTF8"/>
		<title> VTG: 2 Lights On Rotating Pyramid </title>
	</head>
	
	<!--Body-->
	<body onload="main()">
		<canvas id="AMC" width="800" height="600">
			Your browser does not support HTML5 canvas element
		</canvas>
		<script src="gl-matrix-min.js"></script> 
		<script src="2LightsOnRotatingPyramid.js"></script>
		<script type="x-shader/vertex-shader" id="vs">#version 300 es
			in vec4 vPosition;
			in vec3 vNormal;
			uniform mat4 u_model_view_matrix;
			uniform mat4 u_projection_matrix;
			uniform vec3 u_LaR;
			uniform vec3 u_LdR;
			uniform vec3 u_LsR;
			uniform vec4 u_light_positionR;
			uniform vec3 u_LaL;
			uniform vec3 u_LdL;
			uniform vec3 u_LsL;
			uniform vec4 u_light_positionL;
			uniform vec3 u_Ka;
			uniform vec3 u_Kd;
			uniform vec3 u_Ks;
			uniform float u_material_shininess;
			uniform mediump int u_L_key_pressed;
			out vec3 out_phong_ads_color;			
			void main(void)
			{
				if (1 == u_L_key_pressed)
				{
					/*vec4 eyeCoordinates = u_view_matrix * u_model_matrix * vPosition;											\*/
					vec4 eyeCoordinates = u_model_view_matrix *  vPosition;
					vec3 tnorm = normalize(mat3(u_model_view_matrix) * vNormal);
					vec3 light_directionL = normalize(vec3(u_light_positionL - eyeCoordinates));
					float tn_dot_ldL = max(dot(tnorm, light_directionL), 0.0);
					vec3 ambientL = u_LaL * u_Ka;
					vec3 diffuseL = u_LdL * u_Kd * tn_dot_ldL;
					vec3 reflection_vectorL = reflect(-light_directionL, tnorm);
					vec3 viewer_vectorL = normalize(-eyeCoordinates.xyz);
					vec3 specularL = u_LsL * u_Ks * pow(max(dot(reflection_vectorL, viewer_vectorL), 0.0), u_material_shininess);
					out_phong_ads_color = ambientL + diffuseL + specularL;
					vec3 light_directionR = normalize(vec3(u_light_positionR - eyeCoordinates));
					float tn_dot_ldR = max(dot(tnorm, light_directionR), 0.0);
					vec3 ambientR = u_LaR * u_Ka;
					vec3 diffuseR = u_LdR * u_Kd * tn_dot_ldR;
					vec3 reflection_vectorR = reflect(-light_directionR, tnorm);
					vec3 viewer_vectorR = normalize(-eyeCoordinates.xyz);
					vec3 specularR = u_LsR * u_Ks * pow(max(dot(reflection_vectorR, viewer_vectorR), 0.0), u_material_shininess);
					/*out_phong_ads_color = ambientR + diffuseR + specularR;											\*/
					out_phong_ads_color = ambientL + ambientR + diffuseL+ diffuseR + specularL+ specularR;
				}
				else
				{
					out_phong_ads_color = vec3(1.0,1.0,1.0);
				}
				gl_Position = u_projection_matrix * u_model_view_matrix * vPosition;
			}
		</script>
		<script type="x-shader/fragment-shader" id="fs">#version 300 es
			precision highp float;
			in vec3 out_phong_ads_color;
			out vec4 vFragColor;
			void main(void)
			{
				vFragColor = vec4(out_phong_ads_color, 1.0);
			}
		</script>
	</body>
</html> 
